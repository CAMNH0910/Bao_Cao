@{
//  Layout = null;
}

<!-- daterange picker -->
<link rel="stylesheet" href="/Areas/Admin/Content/bower_components/bootstrap-daterangepicker/daterangepicker.css">
<link rel="stylesheet" href="~/Areas/Admin/Content/bower_components/bootstrap-datepicker/dist/css/bootstrap-datepicker.css">
<link rel="stylesheet" href="/Areas/Admin/Content/bower_components/font-awesome/css/font-awesome.min.css">
@*<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">*@


<!-- bootstrap datepicker -->
@*<link rel="stylesheet" href="~/Content/plugins/iCheck/all.css">*@
<!-- Bootstrap Color Picker -->
@*<link rel="stylesheet" href="~/Content/bower_components/bootstrap-colorpicker/dist/css/bootstrap-colorpicker.min.css">*@

<title>Báo cáo tổng hợp chất lượng chuyển phát đơn hàng theo mã KHL</title>
<section class="content-header">
    <h1>
        <small>Báo Cáo </small>
    </h1>
    <ol class="breadcrumb">
        <li><a href="/Admin/Home/Index"><i class="fa fa-dashboard"></i> Home</a></li>
        <li class="active">Báo cáo tổng hợp chất lượng chuyển phát đơn hàng theo mã KHL</li>
    </ol>
</section>
<section class="content">
    <div class="box box-default">
        <div class="box-header with-border">
            <h3 class="box-title">Báo cáo tổng hợp chất lượng chuyển phát đơn hàng theo mã KHL</h3>
            <div class="box-tools pull-right">
                @*<button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-remove"></i></button>*@
                <h3 class="box-title">CL_KHL/CLCP</h3>
            </div>
        </div>
        <!-- /.box-header -->
        <div class="box-body">
            <div class="row">
                <div class="col-md-6">
                    <!-- /.form-group -->
                    <div class="form-group">
                        <label>Từ Ngày </label>
                        <div class="input-group date">
                            <div class="input-group-addon">
                                <i class="fa fa-calendar"></i>
                            </div>
                            <input class="form-control pull-right" id="startdate" type="text" data-date-format="dd/mm/yyyy">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Tỉnh nhận</label>
                        <select class="form-control select2" style="width: 100%;" id="tinh_nhan">
                            <option selected="selected" value="0">Tất Cả</option>
                        </select>
                    </div>

                    <div class="form-group">
                    
                        <div class="form-group">
                            <label>Dịch Vụ</label>
                            <select class="form-control select2" style="width: 100%;" id="Isservice">
                                <option selected="selected" value="10">Tất Cả</option>
                                <option value="0">EMS Tiêu chuẩn</option>
                                <option value="1">COD+ETK</option>
                                <option value="2">ECOD</option>
                                <option value="3">EDG</option>
                                <option value="4">ETT</option>
                            </select>
                        </div>
                    </div>
                  
                    <!-- /.form-group -->
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <label>Đến Ngày</label>
                        <div class="input-group date">
                            <div class="input-group-addon">
                                <i class="fa fa-calendar"></i>
                            </div>
                            <input class="form-control pull-right" id="enddate" type="text" data-date-format="dd/mm/yyyy">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Tỉnh trả</label>
                        <select class="form-control select2" style="width: 100%;" id="tinh_tra">
                            <option selected="selected" value="0">Tất cả</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Khách Hàng</label>
                        <textarea rows="2" class="form-control" id="listcusotmer" placeholder="Nhập Mã Khách Hàng"></textarea>
                    </div>
                   
                    <!-- /.form-group -->
                    <!-- /.form-group -->

                </div>

            </div>

            <div class="row">
                <div class="col-md-4">
                    <button type="button" class="btn btn-default btn-lrg ajax" id="btnreport">Tìm Kiếm</button>
                </div>
            </div>
            <div class="box-header">
                <h3 class="box-title">Báo cáo tổng hợp chất lượng chuyển phát đơn hàng theo mã KHL</h3>
            </div>
            <div style="overflow-x:auto;">
                <table id="example1" class="table table-bordered table-hover">
                    <thead>
                        <tr class="bg-light-blue color-palette">
                            <th rowspan="2" class="text-center">STT</th>
                            <th rowspan="2" class="text-center">Tỉnh nhận</th>
                            <th rowspan="2" class="text-center">Tỉnh trả</th>                         
                            <th rowspan="2" class="text-center">Tổng SL</th>
                            <th colspan="2" class="text-center">Phát Thành Công</th>
                            <th colspan="2" class="text-center">Phát Không Thành Công</th>
                            <th colspan="2" class="text-center">Phát Hoàn Thành Công</th>
                            
                        </tr>
                        <tr class="bg-light-blue color-palette">
                            <th class="text-center">Số Lượng</th>
                            <th class="text-center">Tỷ Lệ</th>
                            <th class="text-center">Số Lượng</th>
                            <th class="text-center">Tỷ Lệ</th>
                            <th class="text-center">Số Lượng</th>
                            <th class="text-center">Tỷ Lệ</th>
                           
                        </tr>
                    </thead>
                    <tbody id="listtotaldatacustomer"></tbody>
                </table>
            </div>
            <div class="loading-element">
                <i class="fa fa-spinner fa-spin"></i>
                Vui lòng chờ giây lát...
            </div>
            



        </div>
    </div>


    <!-- /.box-body -->





</section>



<script>
    $(document).ready(function () {
        $("#startdate").datepicker({
            dateFormat: "dd/mm/yyyy"
        }).datepicker("setDate", "0");

        $("#enddate").datepicker({
            dateFormat: "dd/mm/yyyy"
        }).datepicker("setDate", "0");
    });


    $("#btnreport").click(function () {

        // goi ham Detail
        $("#listtotaldatacustomer tr").remove();
        detail();
        
    });

    //Phần lấy dữ liệu tỉnh nhận
    $(document).ready(function () {

        $.getJSON("/TotalDataCustomer/ProvinceCode", function (data) {
            $.each(data, function (i, data) {

                $('<option>',
                   {
                       value: data.PROVINCECODE,
                       text: data.PROVINCENAME
                   }).html(data.PROVINCECODE + '-' + data.PROVINCENAME).appendTo("#endpostcode");
            });
        })

    });

    $.getJSON("/QualityKHDelivery/Provincenhan", function (data) {
        $('#tinh_nhan').html(data);
    })

    $.getJSON("/QualityKHDelivery/Provincetra", function (data) {
        $('#tinh_tra').html(data);
    })


    $(document).ready(function () {
        $('.loading-element').hide();
    });

    //Phần chi tiết của bảng tổng hợp sản lượng đi phát
    function detail(p) {
        $.ajax({
            url: '@Url.Action("ListDetailedTotalDataCustomerReport", "TotalDataCustomer")',
            beforeSend: function () {
                $('.loading-element').show();
            },
            method:'GET',
            dataType: 'html',
            data:
                {
                    customercode: $("#listcusotmer").val(),
                    startdate: $("#startdate").val(),
                    enddate: $("#enddate").val(),
                    startprovince: $('#tinh_nhan').val()+"0000",
                    endprovince: $('#tinh_tra').val() + "0000",
                    isservice: $("#Isservice").val(),
                   
                    
                    
                },
            success: function (result) {
                // sau khi chay ham thanh cong lay ra ket qua thi bind html vao id listtotaldatacustomer
                    $('.loading-element').hide();
                    $('#listtotaldatacustomer').html(result);
                
            }
        })
    }

   


</script>


