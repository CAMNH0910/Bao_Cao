
@{
//  Layout = null;
}


<!-- daterange picker -->
<link rel="stylesheet" href="/Areas/Admin/Content/bower_components/bootstrap-daterangepicker/daterangepicker.css">
<link rel="stylesheet" href="~/Areas/Admin/Content/bower_components/bootstrap-datepicker/dist/css/bootstrap-datepicker.css">
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />
<title>Báo cáo tổng hợp dữ liệu truyền nhận EMS Center</title>
<section class="content-header">
    <h1>
        <small>Báo Cáo </small>
    </h1>
    <ol class="breadcrumb">
        <li><a href="/Admin/Home/Index"><i class="fa fa-dashboard"></i> Home</a></li>
        <li class="active">Báo cáo tổng hợp dữ liệu truyền nhận EMS Center</li>
    </ol>
</section>
<section class="content">

    <div class="box box-default">
        <div class="box-header with-border">
            <h3 class="box-title">Báo cáo tổng hợp dữ liệu truyền nhận EMS Center</h3>
            <div class="box-tools pull-right">
                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-remove"></i></button>
            </div>
        </div>


        <!-- /.box-header -->
        <div class="box-header">
            <div class="row">
                <div class="col-md-4">
                    <div class="form-group">
                        <label>Lựa Chọn In Bản Kê </label>
                            <select class="form-control" style="width: 100%;" id="typecomunication">
                                <option selected="selected" value="1">Bản Kê Giao Dịch</option>
                                <option value="2">Bản Kê Đường Thư Bưu Tá </option>
                            </select>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label>Tỉnh  Đóng </label>
                        <select class="form-control select2" style="width: 100%;" id="fromprovince">
                            <option selected="selected" value="0">Chọn Tỉnh Đóng</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <div class="col-md-6">
                            <label>Bưu Cục Đóng </label>
                        </div>
                        <div class="col-md-6 loading-element-fromprovince">
                            <i class="fa fa-spinner fa-spin"></i>
                            Vui lòng chờ giây lát...
                        </div>
                        <select class="form-control select2" style="width: 100%;" id="fromposcode">
                            <option selected="selected" value="0">Tất cả</option>
                        </select>
                    </div>
                </div>

            </div>
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label>Tỉnh  Nhận </label>
                        <select class="form-control select2" style="width: 100%;" id="toprovince">
                            <option selected="selected" value="0">Chọn Tỉnh Nhận</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <div class="col-md-6">
                            <label>Bưu Cục Nhận </label>
                        </div>
                        <div class="col-md-6 loading-element-toprovince">
                            <i class="fa fa-spinner fa-spin"></i>
                            Vui lòng chờ giây lát...
                        </div>
                        <select class="form-control select2" style="width: 100%;" id="toposcode">
                            <option selected="selected" value="0">Tất cả</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4">
                    <label>Từ Ngày </label>
                </div>
                <div class="col-md-4">
                    <label>Đến Ngày</label>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4">
                    <div class="form-group">
                        <div class="input-group date">
                            <div class="input-group-addon">
                                <i class="fa fa-calendar"></i>
                            </div>
                            <input class="form-control pull-right" id="fromdate" type="text" data-date-format="dd/mm/yyyy">
                        </div>
                    </div>

                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <div class="input-group date">
                            <div class="input-group-addon">
                                <i class="fa fa-calendar"></i>
                            </div>
                            <input class="form-control pull-right" id="todate" type="text" data-date-format="dd/mm/yyyy">
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <button type="button" class="btn btn-default btn-lrg ajax" id="btnreport">Hiển thị dữ liệu</button>
                        <div class="row">
                            <div class="col-md-6">
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            
        </div>
        <div class="box-body">

            <!-- /.row -->
            <div class="row">
                <div class="col-md-4">
                    <label for="ide2">Mã Cổ Túi:</label>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-6">
                    <input class="form-control" type="text" id="ide2" name="ide2">
                </div>
                <div class="col-lg-6">
                    <a href='' target="_blank" class="btn btn-primary btn-md" onclick="this.href = '/Admin/TransferManagement/MCT_E2_TransferManagementDetailReport?ide2=' + document.getElementById('ide2').value + '&typecomunication=' + document.getElementById('typecomunication').value  ">Xem Bản kê E2</a>
                </div>

            </div>
            
            <div class="box-header">
                <h3 class="box-title">Báo Cáo Tổng hợp</h3>
            </div>
            <div style="overflow-x:auto;">
                <table id="example1" class="table table-bordered table-hover">
                    <thead>
                        <tr class="bg-light-blue color-palette">
                            <th>STT</th>
                            <th>Bưu Cục Đóng</th>
                            <th>Tên Bưu Cục Đóng</th>
                            <th>Bưu Cục Nhận</th>
                            <th>Tên Bưu Cục Nhận</th>
                            <th>Ngày</th>
                            <th>Tổng Số Chuyến Thư</th>
                            <th>Tổng Số Túi</th>
                            <th>Tổng Số Bưu Gửi</th>
                        </tr>
                    </thead>
                    <tbody id="listtransfermanagement">
                    </tbody>
                </table>
            </div>
            <div class="loading-element">
                <i class="fa fa-spinner fa-spin"></i>
                Vui lòng chờ giây lát...
            </div>
            <!-- Modal  -->
            <div class="modal fade" id="myModal" role="dialog">
                <div class="modal-dialog modal-lg">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">Chi tiết tổng hợp dữ liệu truyền nhận EMS Center</h4>
                        </div>
                        <div class="modal-body edit-content">
                            <div type="reset" id="list_test"></div>
                            <div class="loading-element">
                                <i class="fa fa-spinner fa-spin"></i>
                                Vui lòng chờ giây lát...
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Modal so tui -->
            <div class="modal fade" id="myModalSoTui" role="dialog">
                <div class="modal-dialog modal-lg">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                            <h4 class="modal-title">Chi tiết tổng hợp dữ liệu truyền nhận EMS Center</h4>
                        </div>
                        <div class="modal-body edit-content">
                            <div type="reset" id="list_sotui"></div>
                            <div class="loading-element">
                                <i class="fa fa-spinner fa-spin"></i>
                                Vui lòng chờ giây lát...
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>


    <!-- /.box-body -->

</section>



<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>
<script>
    $(document).ready(function () {
        $('.select2').select2();
    });


    $(function () {
        $('#fromdate').datepicker()
        $("#fromdate").datepicker({
            dateFormat: "dd/mm/yyyy"
        }).datepicker("setDate", "0");
    })


    $(function () {
        $('#todate').datepicker()
        $("#todate").datepicker({
            dateFormat: "dd/mm/yyyy"
        }).datepicker("setDate", "0");
    })


    
    $(document).ready(function () {
        //HIDE
        $('.loading-element').hide();
        $('.loading-element-fromprovince').hide();
        $('.loading-element-toprovince').hide();


        //Phần lấy dữ liệu tỉnh đóng
        $.getJSON("/TransferManagement/ProvinceCode", function (data) {
            $('#fromprovince').html(data);
        })


        //Phần lấy dữ liệu tỉnh Nhận
        $.getJSON("/TransferManagement/ProvinceCode", function (data) {
            $('#toprovince').html(data);
        })

        //Lần đầu load bưu cục đóng = HN
        $.ajax({
            url: "/TransferManagement/PosCode",
            dataType: "json",
            data: { province: 10 },
            success: function (data) {
                $('#fromposcode').html('<option value=0>Tất Cả </option>');
                $('#fromposcode').html(data);
            }
        });

        //Sự kiện thay đổi bưu cục đóng theo khu vực
        $('#fromprovince').change(function () {
            $.ajax({
                url: "/TransferManagement/PosCode",
                beforeSend: function () {
                    $('.loading-element-fromprovince').show();
                },
                dataType: "json",
                data: { province: $("#fromprovince").val() },
                success: function (data) {
                    $('.loading-element-fromprovince').hide();
                    $('#fromposcode').html(data);
                }
            });
        })


        //Lần đầu load bưu cục nhận = HN
        $.ajax({
            url: "/TransferManagement/PosCode",
            dataType: "json",
            data: { province: 10 },
            success: function (data) {
                $('#toposcode').html('<option value=0>Tất Cả </option>');
                $('#toposcode').html(data);
            }
        });



        //Sự kiện thay đổi bưu cục nhận theo khu vực
        $('#toprovince').change(function () {
            $.ajax({
                url: "/TransferManagement/PosCode",
                beforeSend: function () {
                    $('.loading-element-toprovince').show();
                },
                dataType: "json",
                data: { province: $("#toprovince").val() },
                success: function (data) {
                    $('.loading-element-toprovince').hide();
                    $('#toposcode').html(data);
                }
            });
        })
    });


    $("#btnreport").click(function () {
        $("#listtransfermanagement tr").remove();
        // goi ham Detail
        detail();
    });

   
    //Phần chi tiết của bảng tổng hợp sản lượng đi phát
    function detail(p) {
        $.ajax({
            url: '@Url.Action("ListDetailedTransferManagementReport", "TransferManagement")',
            beforeSend: function () {
                $('.loading-element').show();
            },
            dataType: 'html',
            data:
                {
                    //zone: $("#zone").val(),
                    fromprovince: $('#fromprovince').val(),
                    toprovince: $('#toprovince').val(),
                    fromposcode: $('#fromposcode').val(),
                    toposcode: $('#toposcode').val(),
                    fromdate: $('#fromdate').val(),
                    todate: $('#todate').val(),
                    typecomunication: $('#typecomunication').val(),

                },
            success: function (result) {
                // sau khi chay ham thanh cong lay ra ket qua thi bind html vao id listtransfermanagement
                if (result.Code == '01') {
                    swal(
                       'Không Có Số Liệu',
                       '',
                       'error'
                     )
                    
                }
                else {
                    $('.loading-element').hide();
                    $('#listtransfermanagement').html(result);

                }
            }
        })
    }

    
</script>


